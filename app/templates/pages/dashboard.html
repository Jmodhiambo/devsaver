{% extends "base.html" %}
{% block content %}

  <div class="admin-container">

    <div class="resource-list">
      
      <!-- <h1 class="center">Current Resources</h1><br> -->

      <div class="filter-container">
        <form method="get" action="/dashboard" class="resource-filter">
          <input type="hidden" name="filter" value="All">
          <button type="submit" class="{{ 'active' if type == 'All' else '' }}">All</button>
        </form>

        <form method="get" action="/dashboard" class="resource-filter">
          <input type="hidden" name="filter" value="Video">
          <button type="submit" class="{{ 'active' if type == 'Video' else '' }}">Videos</button>
        </form>

        <form method="get" action="/dashboard" class="resource-filter">
          <input type="hidden" name="filter" value="Audio">
          <button type="submit" class="{{ 'active' if type == 'Audio' else '' }}">Audios</button>
        </form>

        <form method="get" action="/dashboard" class="resource-filter">
          <input type="hidden" name="filter" value="Image">
          <button type="submit" class="{{ 'active' if type == 'Image' else '' }}">Images</button>
        </form>

        <form method="get" action="/dashboard" class="resource-filter">
          <input type="hidden" name="filter" value="File">  
          <button type="submit" class="{{ 'active' if type == 'File' else '' }}">Files</button>
        </form>

        <form method="get" action="/dashboard" class="resource-filter">
          <input type="hidden" name="filter" value="Link">
          <button type="submit" class="{{ 'active' if type == 'Link' else '' }}">Links</button>
        </form>

        <form method="get" action="/dashboard" class="search-form">
          <input type="text" name="tags" placeholder="Search by tags" class="resource-search">
          <button type="submit" class="search-btn">Search</button>
        </form>

        <span class="count">Total Resources: {{ resources|length if resources else 0 }}</span><br>
      </div>

      {% if msg %}
        <p class="alert alert-success">{{ msg }}</p><br>
      {% endif %}

      {% if resources %}
        {% for resource in resources %}
          <div class="user-row">
            <span class="resource"><strong>{{ resource.title }}</strong></span>
            <!-- <span class="resource-id">{{ resource.id }}</span> -->
            <span class="resource-download"><strong>{{ resource.type }}</strong></span>
            {% if resource.url and resource.original_filename %}
              <span class="resource">{{ resource.original_filename }}</span>
              <span class="resource-download"><a href="{{ resource.url }}" download="{{ resource.original_filename }}">Download</a></span>
            {% else %}
              <span class="resource">{{ resource.url }}</span>
              <span class="resource-download"><a href="{{ resource.url }}" target="_blank">Open Resource</a></span>
            {% endif %}

            <a href="/resources/edit-resource/{{ resource.id }}" ><button class="edit-btn">Edit</button></a>

            <form action="{{ url_for('delete-resource', resource_id=resource.id) }}" method="post" class="delete-form">
                <button type="submit" class="delete-btn" onclick="return confirm('Are you sure you want to delete this resource?');">Delete</button>
            </form>

          </div>

        {% endfor %}
      {% elif type %}
        <p>No <strong>{{ type }}s</strong> found. Start by uplolading a new <strong>{{ type if type != 'Tag Search' else 'Resource' }}</strong>!</p>

      {% else %}
        <p>No resources found. Start by uploading a new resource!</p>
      {% endif %}

      <br><a href="/resources/upload" class="upload-link"><button class="upload-btn">Add New Resource</button></a>
    </div>
  </div>

{% endblock %}